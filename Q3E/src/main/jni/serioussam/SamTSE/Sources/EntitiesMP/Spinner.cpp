/*
 * This file is generated by Entity Class Compiler, (c) CroTeam 1997-98
 */

#line 17 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"

#include "EntitiesMP/StdH/StdH.h"

#include <EntitiesMP/Spinner.h>
#include <EntitiesMP/Spinner_tables.h>
CEntityEvent *ESpinnerInit::MakeCopy(void) { CEntityEvent *peeCopy = new ESpinnerInit(*this); return peeCopy;}
ESpinnerInit::ESpinnerInit() : CEntityEvent(EVENTCODE_ESpinnerInit) {;
 ClearToDefault(penParent);
 ClearToDefault(penTwister);
 ClearToDefault(vRotationAngle);
 ClearToDefault(tmSpinTime);
 ClearToDefault(fUpSpeed);
 ClearToDefault(bImpulse);
 ClearToDefault(tmImpulseDuration);
};
void CSpinner::SetDefaultProperties(void) {
  m_penParent = NULL;
  m_aSpinRotation = FLOAT3D(0.0f , 0.0f , 0.0f);
  m_vSpeed = FLOAT3D(0.0f , 0.0f , 0.0f);
  m_tmExpire = 0.0f;
  m_vLastSpeed = FLOAT3D(0.0f , 0.0f , 0.0f);
  m_bImpulse = FALSE ;
  m_tmWaitAfterImpulse = 0.0f;
  m_tmSpawn = 0.0f;
  m_vSpinSpeed = FLOAT3D(0.0f , 0.0f , 0.0f);
  CRationalEntity::SetDefaultProperties();
}
BOOL CSpinner::
#line 54 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Main(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CSpinner_Main
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_ESpinnerInit, "CSpinner::Main expects 'ESpinnerInit' as input!");  const ESpinnerInit &esi = (const ESpinnerInit &)__eeInput;
#line 57 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if((! (esi  . penParent  -> GetPhysicsFlags  () & EPF_MOVABLE )) || 
#line 58 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
(esi  . penParent  == NULL ) || (esi  . penParent  == NULL ))
#line 59 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
{
#line 60 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Destroy  ();
#line 61 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Return(STATE_CURRENT,EVoid());
#line 61 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
return TRUE;
#line 62 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 63 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
ASSERT  (esi  . penParent  != NULL );
#line 64 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
ASSERT  (esi  . penTwister  != NULL );
#line 67 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
CTwister  & penTwister  = (CTwister  &) * esi  . penTwister ;
#line 68 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
CMovableEntity  & penParent  = (CMovableEntity  &) * esi  . penParent ;
#line 69 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_penParent  = esi  . penParent ;
#line 70 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_aSpinRotation  = esi  . vRotationAngle ;
#line 71 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_bImpulse  = esi  . bImpulse ;
#line 72 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(m_bImpulse ){
#line 73 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_tmWaitAfterImpulse  = esi  . tmSpinTime  - esi  . tmImpulseDuration ;
#line 74 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(m_tmWaitAfterImpulse  <= 0.0f){m_tmWaitAfterImpulse  = 0.01f;}
#line 75 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 77 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_vSpinSpeed  = ((CMovableEntity  &) * m_penParent ) . en_vCurrentTranslationAbsolute ;
#line 78 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_vSpinSpeed  = FLOAT3D (0.0f , 0.0f , m_vSpinSpeed  . Length  ());
#line 81 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
InitAsVoid  ();
#line 82 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
SetPhysicsFlags  (EPF_MODEL_IMMATERIAL );
#line 83 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
SetCollisionFlags  (ECF_IMMATERIAL );
#line 85 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(! m_bImpulse ){
#line 86 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_tmExpire  = _pTimer  -> CurrentTick  () + esi  . tmSpinTime ;
#line 87 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}else {
#line 88 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_tmExpire  = _pTimer  -> CurrentTick  () + esi  . tmImpulseDuration ;
#line 89 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 90 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_tmSpawn  = _pTimer  -> CurrentTick  ();
#line 93 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_vSpeed  = FLOAT3D (penTwister  . en_mRotation  (1 , 2) , penTwister  . en_mRotation  (2 , 2) , penTwister  . en_mRotation  (3 , 2)) * esi  . fUpSpeed ;
#line 96 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
ANGLE3D aRnd ;
#line 97 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
FLOATmatrix3D m ;
#line 98 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
aRnd  (1) = FRnd  () * 360.0f;aRnd  (2) = FRnd  () * 30.0f;aRnd  (3) = 0.0f;
#line 99 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
MakeRotationMatrixFast  (m  , aRnd );
#line 100 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_vSpeed  = m_vSpeed  * m ;
#line 103 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Jump(STATE_CURRENT,0x015c0003, FALSE, EInternal());return TRUE;}BOOL CSpinner::H0x015c0003_Main_03(const CEntityEvent &__eeInput)
#line 104 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
{
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0003
if(!(_pTimer  -> CurrentTick  () < m_tmExpire )){ Jump(STATE_CURRENT,0x015c0004, FALSE, EInternal());return TRUE;}
#line 106 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(m_penParent  -> GetFlags  () & ENF_DELETED ){
#line 107 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Destroy  ();
#line 108 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Return(STATE_CURRENT,EVoid());
#line 108 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
return TRUE;
#line 109 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 111 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(((CMovableEntity  &) * m_penParent ) . en_vCurrentTranslationAbsolute  != m_vLastSpeed  || 
#line 112 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . en_vCurrentTranslationAbsolute  == FLOAT3D (0.0f , 0.0f , 0.0f)){
#line 114 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . en_vCurrentTranslationAbsolute  += m_vSpeed ;
#line 115 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
m_vLastSpeed  = ((CMovableEntity  &) * m_penParent ) . en_vCurrentTranslationAbsolute ;
#line 116 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}else {
#line 118 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . SetDesiredTranslation  (m_vSpinSpeed );
#line 119 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 122 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(! m_bImpulse ){
#line 123 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . en_aDesiredRotationRelative  = m_aSpinRotation ;
#line 124 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}
#line 125 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x015c0001, FALSE, EBegin());return TRUE;}BOOL CSpinner::H0x015c0001_Main_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0001
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x015c0002, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CSpinner::H0x015c0002_Main_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0002
;Jump(STATE_CURRENT,0x015c0003, FALSE, EInternal());return TRUE;
#line 126 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
}BOOL CSpinner::H0x015c0004_Main_04(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0004

#line 128 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . en_aDesiredRotationRelative  = ANGLE3D (0.0f , 0.0f , 0.0f);
#line 131 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
if(!(m_bImpulse )){ Jump(STATE_CURRENT,0x015c0007, FALSE, EInternal());return TRUE;}
#line 132 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
((CMovableEntity  &) * m_penParent ) . SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 133 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
SetTimerAfter(m_tmWaitAfterImpulse );
Jump(STATE_CURRENT, 0x015c0005, FALSE, EBegin());return TRUE;}BOOL CSpinner::H0x015c0005_Main_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0005
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x015c0006, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CSpinner::H0x015c0006_Main_06(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0006
;Jump(STATE_CURRENT,0x015c0007, FALSE, EInternal());return TRUE;}BOOL CSpinner::H0x015c0007_Main_07(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x015c0007

#line 137 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Destroy  ();
#line 139 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
Return(STATE_CURRENT,EVoid());
#line 139 "/data/data/com.termux/files/home/doom3/SeriousSamClassic-1.10.7/SamTSE/Sources/EntitiesMP/Spinner.es"
return TRUE; ASSERT(FALSE); return TRUE;};